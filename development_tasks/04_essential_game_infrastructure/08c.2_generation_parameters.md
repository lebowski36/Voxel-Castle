# Generation Parameters System
*Created: 2025-06-05 22:59*
*Last Updated: 2025-06-05 22:59*

## Overview
This document outlines the parameter system for world generation in Voxel Castle. The parameter system provides a flexible way to configure various aspects of world generation, from terrain heights to feature frequency.

## Design Goals

1. **Configurability**: Allow fine-tuned control over world generation
2. **Presets**: Provide ready-to-use parameter sets for different world types
3. **Extensibility**: Easy addition of new parameters for future features
4. **Serialization**: Store and load parameters with each world
5. **UI Integration**: Connect parameters to world creation dialog

## Core Components

### WorldParameters Class

**Purpose**: Central storage for all generation parameters

**Key Functionality**:
- [ ] Store and manage all generation parameters
- [ ] Provide default values for each parameter
- [ ] Support parameter presets for different world types
- [ ] Serialize/deserialize parameters to/from save files
- [ ] Parameter validation and range checking

### Parameter Categories

#### Terrain Parameters
- [ ] Base height (mean terrain level)
- [ ] Terrain variation (min/max deviation from base)
- [ ] Noise scale (horizontal frequency of terrain features)
- [ ] Noise octaves (detail levels in terrain)
- [ ] Mountain frequency/height
- [ ] Valley depth/width

#### Biome Parameters
- [ ] Biome size/scale
- [ ] Temperature gradient scale
- [ ] Humidity gradient scale
- [ ] Biome blending factor
- [ ] Special biome frequency

#### Structure Parameters
- [ ] Structure frequency (per structure type)
- [ ] Minimum distance between structures
- [ ] Village size/density
- [ ] Dungeon frequency/size

#### Cave Parameters
- [ ] Cave frequency
- [ ] Cave size distribution
- [ ] Tunnel width/height range
- [ ] Cavern frequency/size

#### Resource Parameters
- [ ] Ore frequencies (by type)
- [ ] Ore vein size distribution
- [ ] Ore vertical distribution
- [ ] Special resource frequency

### World Type Presets

**Purpose**: Pre-configured parameter sets for different world types

**Preset Types**:
- [ ] **Normal**: Balanced terrain with moderate variation
- [ ] **Flat**: Minimal height variation, good for building
- [ ] **Amplified**: Exaggerated terrain features, high mountains
- [ ] **Islands**: Archipelago-style terrain with water between landmasses
- [ ] **Custom**: User-defined parameter set

## Implementation Details

### Parameter Storage

Parameters will be stored in a hierarchical structure:

```
WorldParameters
├── TerrainParameters
│   ├── baseHeight
│   ├── heightVariation
│   └── ...
├── BiomeParameters
│   ├── biomeScale
│   ├── temperatureScale
│   └── ...
└── ...
```

### Preset Definition

Presets will define parameter values for different world types:

```
// Pseudocode (not actual implementation)
void createNormalPreset(WorldParameters& params) {
    params.terrain.baseHeight = 64;
    params.terrain.heightVariation = 24;
    params.terrain.noiseScale = 0.01;
    // Set other parameters...
}
```

### Parameter Serialization

Parameters will be serialized to JSON for storage in level.dat:

```json
{
  "worldParameters": {
    "terrain": {
      "baseHeight": 64,
      "heightVariation": 24,
      "noiseScale": 0.01
    },
    "biomes": {
      "biomeScale": 0.02,
      "temperatureScale": 0.001
    }
  }
}
```

## User Interface Integration

The parameter system will connect to the UI through:

1. **World Type Selection**: Choosing a preset in the Create New World dialog
2. **Advanced Parameters**: Optional UI for fine-tuning individual parameters
3. **Custom Presets**: Ability to save/load custom parameter sets

## Transition Strategy

### Phase 1: Core Parameter System
- [ ] Define basic parameter structure
- [ ] Implement WorldParameters class
- [ ] Create standard presets (Normal, Flat, Amplified)
- [ ] Connect parameters to terrain generation

### Phase 2: Extended Parameters
- [ ] Add biome parameters
- [ ] Add structure parameters
- [ ] Add cave/resource parameters
- [ ] Implement parameter validation

### Phase 3: UI & Persistence
- [ ] Connect parameters to world creation UI
- [ ] Implement parameter serialization
- [ ] Add parameter loading from level.dat
- [ ] Create advanced parameter editor (optional)

## Technical Notes

### Parameter Range Validation

To ensure world generation remains stable:
- Define valid ranges for each parameter
- Clamp values that exceed these ranges
- Provide warnings for extreme values

### Parameter Dependencies

Some parameters may affect others:
- Implement dependency tracking
- Automatically adjust dependent parameters
- Prevent invalid parameter combinations

### Performance Impact

Monitor how different parameters affect generation performance:
- Document which parameters most impact performance
- Provide performance hints in advanced UI
- Create "Low Performance Impact" presets for slower systems

## Testing Strategy

1. **Preset Testing**: Verify each preset creates appropriate terrain
2. **Extreme Value Testing**: Test with min/max parameter values
3. **Serialization Testing**: Ensure parameters save and load correctly
4. **UI Testing**: Verify UI controls properly affect generation

## Next Steps

1. Define complete parameter list for terrain generation
2. Design parameter class structure
3. Implement basic parameter storage
4. Create standard presets
5. Connect parameters to world generator
